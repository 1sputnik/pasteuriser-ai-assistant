***<h1 align = "center">Файл data_form.h и data_form.cpp</a>***

## **Цель:**

<p align = "justify">
Считать данные, лежащие в csv-файлах, создать основу для хранения и обработки в оперативной памяти, оптимизация процесса считывания, хранения и обращения к данным.
</p>

## **Анализ данных и постановка задачи хранения в оперативной памяти:**

<p align = "justify"> 
Данные, хранящиеся в csv-файлах, представляют собой таблицу. В первом столбце указан cid датчика. Во втором столбце указывается дискретный момент времени. В третий столбец записывается уже некоторая информация, относящаяся к конкретному cid, например, степень открытия или температура в градусах Цельсия и т.д. Для удобства представления данных в оперативной памяти и удобства  компьютера необходимо определить структуру хранения и типы данных необходимые для этого.  
</p>  

## **Решение по коду:**  

<p align = "justify">
Для удобства представления данных в оперативной памяти создается структура (DATA), в которой каждому столбцу из таблицы csv-файла соответствует свой тип данных:
</p>
<p align = "justify">
Сid датчика тип данных - __int8
</p>
<p align = "justify">
Дискретный момент времени - тип данных unsigned int
</p>
<p align = "justify">
Некоторая информация, относящаяся к конкретному cid - тип данных double
</p>

## **Оптимизация считывания и хранения в оперативной памяти:**

<p align = "justify">
Для обучения нейронной сети требуется считать более 3-х миллионов значений, или хотя бы часть из них. Язык С++ обладает стандартной библиотекой шаблонов, которая содержит подходящие под задачи классы. В частности это Vector и List, остальные шаблоны не подходят ввиду особенностей из использования.
</p>

<p align = "justify">
    
</p>

<p align = "justify">
Однако при загрузке данных из файла экспериментальным путем было выявлено, что из-за особенностей выделения памяти ни Vector, ни List, не подходят для использования в системе.
</p>

<p align = "justify">
List несмотря на простое добавление элементов требовал большего количества памяти чем Vector. так же обращение к памяти через List занимает больше времени в связи с необходимостью пройти весь список.
</p>

<p align = "justify">
Vector несмотря на простое добавление элементов, быстрое обращение к памяти и срвнительно небольшое количество требуемой памяти, Vector требует значительно большее количество времени для считывания, в связи с особенностями выделения памяти в Vector. Выделение памяти осуществляется по правилу (Размер DATA) * 2^n, где n зависит от того, сколько раз выделяется память и не превышет ли количество запрашиваемой памяти ныне располагаемую память. Условно выделение памяти можно представить следующим образом: Добавляется новый элемент, если элементы превышают количество выделенной памяти ((Размер DATA) * 2^n), то Vector копирует имеющиется данные в буфферный массив, освобождает основную память, после чего выделяет память в размере (Размер DATA) * 2^(n+1), после чего копирует имеющиеся значения в основной массив, освобождает память в буфферном массиве и добавляет новое значение. Фактически память выделяется по закону 2^n, что примелимо при небольшом количестве данных, но совершенно не примелимо при больших объемах информации, ибо количество перезаписей возрастает в разы, что соответствующе сказывается на производительности.
</p>

## **Решение по коду:**  

<p align = "justify">
Для удобства хранения и представления было решено создать отдельный класс DataVector. Особенностью данного класса является возможность выделения памяти под конкретный файл или конкретное количество записей. В частности в отличии от стандартного Vector данный клас содержит 2 новых конструктора, один из которых принимает путь к файлу, а второй число записей.
</p>

<p align = "justify">
 В первом конструкторе, получая путь к файлу, метод подсчитывает количество строк в файле и выделяет память в размере (количество строк) + 1.   
</p>

<p align = "justify">
 Во втором конструкторе, получая число, метод выделяет память в размере числа.   
</p>

<p align = "justify">
Для удобства считывания были добавлены дружественные функции load_data и dump_data, которые загружают и выгружают данные из DataVector
</p>

<p align = "justify">
В результате данных измений класс DataVector утрачивает возможность принимать значения не DATA, но при этом возрастает скорость считывания больших объемов данных из файла в разы. При этом память выделяется в необходимом объеме сразу же.
</p>

## **Вывод:**  

<p align = "justify">
Были проведены основные мероприятия по оптимизации считывания и хранения данных в операционной памяти. в результате данных изменений вызросла скорость обработки(считывания) и уменьшилось количество необходимой оперативной памяти.
</p>